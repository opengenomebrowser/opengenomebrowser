var SwissBioPics;SwissBioPics=(()=>{"use strict";var e={856:(e,t,s)=>{s.r(t);const l=document.createElement("template");l.innerHTML='<style>span.subcell_description {\n    padding-left: 0.5em;\n}\n\nul.subcell_present,\nul.notpresent {\n    list-style-type: none;\n    list-style: none;\n    padding: 0px;\n}\n\nul.subcell_present li::before {\n    content: "✓"\n}\n\nul.notpresent li::before {\n    content: "✗";\n}\n\n#swissbiopic {\n    display: grid;\n    grid-template-areas: "picture terms";\n    grid-template-columns: 1fr 1fr;\n    grid-column-gap: 10px;\n}\n\n.svg {\n    grid-area: picture;\n}\n\n.terms {\n    grid-area: terms;\n}\n</style><div id="swissbiopic"><div class="terms"></div></div>';class n extends HTMLElement{static anyNonOkIsAnError(){if(!response.ok)throw Error(response.statusText);return response}constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.shadow.appendChild(l.content.cloneNode(!0)),this.wrapper=this.shadow.querySelector("#swissbiopic"),this.develop=null!==this.getAttribute("developer")&&void 0!==this.getAttribute("developer"),this.develop&&console.log("in development mode"),this.sls=this.getAttribute("sls"),this.gos=this.getAttribute("gos"),this.taxid=this.getAttribute("taxid")}render(){let e=fetch(((e,t,s,l)=>{let n="https://www.swissbiopics.org/";!0===this.develop&&(n="http://localhost:8081/",console.log("developer",n));let i=`${n}/api/${t}/sl/${e}`;return null!=s&&(i=`${n}/api/${t}/go/${s}`),i})(this.sls,this.taxid,this.gos)).then(this.anyNonOkIsAnError).then((e=>e.text())).then((e=>this.wrapper.insertAdjacentHTML("beforeend",e)));this.liItemTemplate&&(e=e.then((()=>this.addListOfPresentSubcellularLocations(this.sls,this.wrapper,this.terms))).then((()=>this.addListOfNotPresentSubcellularLocations(this.sls,this.wrapper,this.terms))).then((()=>this.addListOfNotFoundSubcellularLocations(this.sls,this.wrapper,this.terms)))),e.then((()=>this.addEventHandlers(this.wrapper,this.terms))).then((()=>this.shadow.appendChild(this.wrapper))).then((()=>this.shadow.dispatchEvent(new CustomEvent("svgloaded")))).catch((e=>{this.showErrorMessageToUser(e,this.shadow),this.shadow.dispatchEvent(new CustomEvent("failedtoload"))}))}connectedCallback(){const e="sibSwissBioPicsSlLiItem",t=document.getElementById(e);if(null!==t)this.liItemTemplate=t.content,this.terms=this.shadow.querySelector(".terms"),this.setAttribute("contentid",e);else{if(null===this.getAttribute("contentid"))throw"Neither #sibSwissBioPicsSlLiItem template nor #sibSwissBioPicsSlUlOverride content set";{const e=document.getElementById(this.getAttribute("contentid"));if(null===e)throw"Neither #sibSwissBioPicsSlLiItem template nor #sibSwissBioPicsSlUlOverride content set";e.parentElement.removeChild(e),this.wrapper.appendChild(e),e.hidden=!1,this.terms=e}}const s=document.getElementById("sibSwissBioPicsStyle");if(null!==this.getAttribute("styleid")){let e=document.getElementById(this.getAttribute("styleid")).content.cloneNode(!0);this.shadow.append(e)}else if(null!==s){let e=s.content.cloneNode(!0);this.shadow.append(e);const t=document.createElement("style");t.innerText=".subcell_present li,\n.subcell_present path,\n.subcell_present circle,\n.subcell_present ellipse,\n.subcell_present polygon,\n.subcell_present rect,\n.subcell_present polyline,\n.subcell_present line {\n    fill: lightblue;\n    fill-opacity: .50;\n    background-color: lightblue;\n}\n\n.subcell_present ul.lookedAt,\n.subcell_present path.lookedAt,\n.subcell_present circle.lookedAt,\n.subcell_present ellipse.lookedAt,\n.subcell_present polygon.lookedAt,\n.subcell_present rect.lookedAt,\n.subcell_present polyline.lookedAt,\n.subcell_present line.lookedAt {\n    stroke: blue;\n    fill-opacity: .75;\n}\n\n.lookedAt {\n    stroke: orange;\n    fill: red;\n    fill-opacity: .25;\n    background-color: orange;\n}\n\n/*Cytoskeleton is special cased to not do a fill*/\n\n#SL0090 .lookedAt {\n    fill: none;\n}\n",this.shadow.append(t)}this.render()}showErrorMessageToUser(e,t){console.log(e),t.innerHTML='<span class="failure">Failed to fetch a SwissBioPic, please try again later.</span>'}findAndSort(e,t){const s=new Set;return Array.from(e.querySelectorAll(t)).sort(((e,t)=>e.querySelector(":scope > .subcell_name").textContent.localeCompare(t.querySelector(":scope > .subcell_name").textContent))).filter((e=>{let t=e.querySelector(":scope > .subcell_name").parentElement.id;return!s.has(t)&&(s.add(t),!0)}))}addListOfPresentSubcellularLocations(e,t,s){let l=document.createElement("ul");l.className="subcell_present";const n=this.findAndSort(t,":scope svg .subcellular_location.subcell_present");for(let e of n){let t=this.liItemTemplate.cloneNode(!0);l.appendChild(t);let s=l.lastElementChild,n=s.querySelectorAll(":scope .subcell_name")[0];n.href="https://www.uniprot.org/locations/"+e.id.substring(2),n.textContent=e.querySelector(":scope > .subcell_name").textContent,s.querySelectorAll(":scope .subcell_description")[0].textContent=e.querySelector(":scope > .subcell_description").textContent,s.id=e.id+"term",s.className="subcell_present"}s.appendChild(l)}addListOfNotPresentSubcellularLocations(e,t,s){let l=document.createElement("ul");l.className="notpresent";const n=this.findAndSort(t,":scope svg .subcellular_location:not(.subcell_present)");for(let e of n){let t=this.liItemTemplate.cloneNode(!0);l.appendChild(t);let s=l.lastElementChild,n=s.querySelectorAll(":scope .subcell_name")[0];n.href="https://www.uniprot.org/locations/"+e.id.substring(2),n.textContent=e.querySelector(":scope > .subcell_name").textContent,s.querySelectorAll(":scope .subcell_description")[0].textContent=e.querySelector(":scope > .subcell_description").textContent,s.id=e.id+"term",s.className="notpresent"}s.appendChild(l)}addListOfNotFoundSubcellularLocations(e,t,s){let l=document.createElement("ul");l.className="subcell_notfound";for(let s of e.split(",")){let e="SL"+s.padStart(4,"0");if(!t.querySelector("#"+e)){let t=this.liItemTemplate.cloneNode(!0);l.appendChild(t),t="subcell_notfound";let n=l.lastElementChild,i=n.querySelectorAll(":scope .subcell_name")[0],o=n.querySelectorAll(":scope .subcell_name")[0];i.href="https://www.uniprot.org/locations/"+s,i.textContent=e,n.id=`SL${s.padStart(4,"0")}term`,fetch(`https://sparql.uniprot.org/sparql?query=PREFIX+skos%3a+%3chttp%3a%2f%2fwww.w3.org%2f2004%2f02%2fskos%2fcore%23%3e%0d%0aPREFIX+rdfs%3a+%3chttp%3a%2f%2fwww.w3.org%2f2000%2f01%2frdf-schema%23%3e%0d%0aSELECT+%3flabel+%3fcomment+%0d%0aWHERE++%7b%0d%0a%09%3chttp%3a%2f%2fpurl.uniprot.org%2flocations%2f${s}%3e+skos%3aprefLabel+%3flabel+%3b+rdfs%3acomment+%3fcomment+.%0d%0a%7d&format=srj`).then((e=>e.json())).then((e=>this.injectNameAndDescription(e,i,o)))}}s.appendChild(l)}injectNameAndDescription(e,t,s){t.textContent=e.results.bindings[0].label.value,s.textContent=e.results.bindings[0].comment.value}addEventHandlers(e,t){const s="path, circle, ellipse, polygon, rect, polyline, line";for(let l of e.querySelectorAll(":scope svg .subcellular_location")){for(let e of l.querySelectorAll(":scope "+s))e.addEventListener("mouseenter",(e=>this.highLight(e,l,s))),e.addEventListener("mouseleave",(e=>this.removeHiglight(e,l,s)));if(l.id){let e=t.querySelector(`:scope #${l.id}term`);null!==e&&(e.addEventListener("mouseenter",(e=>this.highLight(e,l,s))),e.addEventListener("mouseleave",(e=>this.removeHiglight(e,l,s))),e.addEventListener("touchstart",(e=>this.highLight(e,l,s)),{passive:!0}),e.addEventListener("touchend",(e=>this.removeHiglight(e,l,s)),{passive:!0}))}}}highLight(e,t,s){const l=t.querySelector(".subcell_name");l.setAttribute("visibility","visible"),l.setAttribute("x","0"),l.setAttribute("y","1em");const n=t.querySelector(".subcell_description");n.setAttribute("visibility","visible"),n.setAttribute("x","0"),n.setAttribute("y","2em"),n.setAttribute("width","20em");for(let e of t.querySelectorAll(s))e.classList.add("lookedAt");let i=this.shadow.getElementById(t.id+"term");null!==i&&i.classList.add("lookedAt")}removeHiglight(e,t,s){t.querySelector(".subcell_name").setAttribute("visibility","hidden"),t.querySelector(".subcell_description").setAttribute("visibility","hidden");for(let e of t.querySelectorAll(s))e.classList.remove("lookedAt");let l=this.shadow.getElementById(t.id+"term");null!==l&&l.classList.remove("lookedAt")}}window.customElements.get("sib-swissbiopics-sl")||window.customElements.define("sib-swissbiopics-sl",n)}},t={};function s(l){if(t[l])return t[l].exports;var n=t[l]={exports:{}};return e[l](n,n.exports,s),n.exports}return s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s(856)})();